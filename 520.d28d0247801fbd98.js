"use strict";(self.webpackChunkpwa=self.webpackChunkpwa||[]).push([[520],{4520:(Ge,X,c)=>{c.r(X),c.d(X,{CauSieuVoViModule:()=>Fe});var w=c(9808),k=c(6696),i=c(5e3),O=c(8306),ue=(c(350),c(520));let W=(()=>{class t{constructor(e){this.http=e}getCauSieuVoViList(){return new O.y(s=>{s.next(JSON.parse(localStorage.getItem("csvv")||"{data: []}"))})}getCauSieuVoViById(e){return JSON.parse(localStorage.getItem("csvv")||"{data: []}"),new O.y(r=>{var d;r.next({data:null===(d=JSON.parse(localStorage.getItem("csvv")||"{data: []}"))||void 0===d?void 0:d.data.find(l=>l.key===e)})})}addCauSieuVoVi(e,n){return localStorage.setItem("csvv",JSON.stringify(e)),new O.y(d=>{var l;d.next({data:null===(l=JSON.parse(localStorage.getItem("csvv")||"{data: []}"))||void 0===l?void 0:l.data.find(u=>u.key===n)})})}updateCauSieuVoVi(e,n){return localStorage.setItem("csvv",JSON.stringify(e)),new O.y(d=>{var l;d.next({data:null===(l=JSON.parse(localStorage.getItem("csvv")||"{data: []}"))||void 0===l?void 0:l.data.find(u=>u.key===n)})})}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(ue.eN))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var q=c(5113),ee=c(6256),$=c(5899),U=c(3954),F=c(9224),E=c(508);function ce(t,o){1&t&&i._UZ(0,"mat-progress-bar",5)}function he(t,o){if(1&t&&(i.TgZ(0,"mat-grid-tile",3),i.TgZ(1,"mat-card",6),i.TgZ(2,"mat-card-title"),i._uU(3),i.qZA(),i.TgZ(4,"mat-card-subtitle"),i._uU(5),i.qZA(),i.qZA(),i.qZA()),2&t){const e=o.$implicit,n=i.oxw();let s,r;i.Q6J("routerLink",null==e?null:e.key),i.xp6(3),i.Oqu(null==(s=n.getCardDetails(e))?null:s.title),i.xp6(2),i.hij("\u0110\xe3 ghi nh\u1eadn: ",null==(r=n.getCardDetails(e))?null:r.count," linh h\u1ed3n")}}let ve=(()=>{class t{constructor(e,n,s,r){this.cauSieuVoViService=e,this.breakpointObserver=n,this.authService=s,this.router=r,this.cauSieuVoViList=[],this.cols=1,this.isLoading=!1}ngOnInit(){var e,n;(null===(n=null===(e=this.authService.currentUser)||void 0===e?void 0:e.role)||void 0===n?void 0:n.includes("administrator"))?(this.breakpointObserver.observe(["(max-width: 600px)"]).subscribe(s=>{this.cols=s.matches?1:4}),this.getCauSieuVoViList()):this.router.navigate(["/tac-vu"])}getCauSieuVoViList(){this.isLoading=!0,this.cauSieuVoViService.getCauSieuVoViList().subscribe(e=>{console.log(e),(null==e?void 0:e.data)?(this.cauSieuVoViList=null==e?void 0:e.data,this.isLoading=!1):this.isLoading=!1},e=>{this.isLoading=!1,console.log(e)})}getCardDetails(e){var n,s,r,d,l,u,a,g,p;const y=null===(s=null===(n=null==e?void 0:e.formGroup)||void 0===n?void 0:n.find(h=>"thong-tin-chung"===h.key))||void 0===s?void 0:s.control,T=null===(r=null==y?void 0:y.find(h=>"nam-am-lich"===h.key))||void 0===r?void 0:r.value,Z=null===(d=null==y?void 0:y.find(h=>"thang-am-lich"===h.key))||void 0===d?void 0:d.value,_=null===(l=null==y?void 0:y.find(h=>"ngay-am-lich"===h.key))||void 0===l?void 0:l.value,v=null===(a=null===(u=null==e?void 0:e.formGroup)||void 0===u?void 0:u.find(h=>"thong-tin-cau-sieu"===h.key))||void 0===a?void 0:a.control;return{title:`C\u1ea7u si\xeau v\xe0o ng\xe0y ${_} th\xe1ng ${Z} n\u0103m ${T}`,count:null===(p=null===(g=null==v?void 0:v.find(h=>"linh-hon"===h.key))||void 0===g?void 0:g.value)||void 0===p?void 0:p.length}}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(W),i.Y36(q.Yg),i.Y36(ee.e),i.Y36(k.F0))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-cau-sieu-vo-vi-list"]],decls:5,vars:4,consts:[["mode","indeterminate",4,"ngIf"],["rowHeight","2:1",1,"w-100",3,"cols"],["class","csvv-item w-100",3,"routerLink",4,"ngFor","ngForOf"],[1,"csvv-item","w-100",3,"routerLink"],[1,"w-100","h-100"],["mode","indeterminate"],["matRipple","",1,"w-100","h-100"]],template:function(e,n){1&e&&(i.YNc(0,ce,1,0,"mat-progress-bar",0),i.TgZ(1,"mat-grid-list",1),i.YNc(2,he,6,3,"mat-grid-tile",2),i.TgZ(3,"mat-grid-tile",3),i._UZ(4,"mat-card",4),i.qZA(),i.qZA()),2&e&&(i.Q6J("ngIf",n.isLoading),i.xp6(1),i.Q6J("cols",n.cols),i.xp6(1),i.Q6J("ngForOf",n.cauSieuVoViList),i.xp6(1),i.Q6J("routerLink","them-moi"))},directives:[w.O5,$.pW,U.Il,w.sg,U.DX,k.rH,F.a8,E.wG,F.n5,F.$j],styles:[".csvv-item{cursor:pointer}  .csvv-item .mat-grid-tile-content{padding:1rem}"]}),t})();var te=c(7616),ie=c(5484),ne=c(7261),oe=c(8966),fe=c(4510),se=c(5245);function ge(t,o){1&t&&i._UZ(0,"mat-progress-bar",3)}function pe(t,o){1&t&&(i.TgZ(0,"div",4),i.TgZ(1,"mat-icon",5),i._uU(2,"error_outline"),i.qZA(),i.TgZ(3,"p"),i._uU(4,"H\xe3y ho\xe0n th\xe0nh to\xe0n t\u1ea5t c\u1ea3 th\xf4ng tin b\u1eaft bu\u1ed9c tr\u01b0\u1edbc khi l\u01b0u"),i.qZA(),i.qZA())}let re=(()=>{class t{constructor(e,n,s,r,d,l,u,a){this.editorService=e,this.cauSieuVoViService=n,this.authService=s,this.route=r,this.breakpointObserver=d,this.router=l,this._snackBar=u,this.matDialog=a,this.horizontalPosition="center",this.verticalPosition="bottom",this.isLoading=!1,this.contentEditable=!1}ngOnInit(){var e,n,s,r;(null===(n=null===(e=this.authService.currentUser)||void 0===e?void 0:e.role)||void 0===n?void 0:n.includes("administrator"))?(this._id=void 0,this.route.params.subscribe(d=>{this._id=d._id}),this.onGetDocument("cau-sieu-vo-vi")):this.router.navigate(["/tac-vu"]),(null===(r=null===(s=this.authService.currentUser)||void 0===s?void 0:s.role)||void 0===r?void 0:r.includes("administrator"))?(this.breakpointObserver.observe(["(max-width: 600px)"]).subscribe(d=>{this.contentEditable=!d.matches}),this._id=void 0,this.route.params.subscribe(d=>{this._id=d._id}),this.onGetDocument("cau-sieu-vo-vi")):this.router.navigate(["/tac-vu"])}onGetDocument(e){this.isLoading=!0,this._id?this.cauSieuVoViService.getCauSieuVoViById(this._id).subscribe(n=>{var s;n&&(this.cauSieuVoVi=n.data,this.editorService.getJSON(null===(s=this.cauSieuVoVi)||void 0===s?void 0:s.documentKey).subscribe(r=>{var d,l,u;this.so=r.data,this.so.formGroup=null===(d=this.cauSieuVoVi)||void 0===d?void 0:d.formGroup,this.so.key=null===(l=this.cauSieuVoVi)||void 0===l?void 0:l.key,this.so._id=null===(u=this.cauSieuVoVi)||void 0===u?void 0:u._id,this.isLoading=!1}))},n=>{this.isLoading=!1,console.log(n)}):this.editorService.getJSON(e).subscribe(n=>{this.so=n.data,this.isLoading=!1})}onSaveCauSieuVoVi(e,n){var s,r,d,l,u,a,g,p,y;this.isLoading=!0;let T=[];const Z=_=>{null==_||_.forEach(v=>{var D;null===(D=null==v?void 0:v.control)||void 0===D||D.forEach(h=>{let J=null==T?void 0:T.find(A=>(null==A?void 0:A.key)===v.key);"formArray"!==(null==h?void 0:h.type)?(null==h?void 0:h.required)&&!(null==h?void 0:h.value)&&(J?J.control.push(h):T.push({key:null==v?void 0:v.key,title:null==v?void 0:v.title,control:[h]})):Z(null==h?void 0:h.value)})})};if(Z(null==e?void 0:e.formGroup),(null==T?void 0:T.length)>0)this.errorGroup=T,this.errorMessageDialogRef=this.matDialog.open(n),this.isLoading=!1;else{let _=new ie.T;_._id=e._id,_.documentKey=e.documentKey,_.formGroup=e.formGroup;const v=null===(r=null===(s=_.formGroup)||void 0===s?void 0:s.find(f=>"thong-tin-chung"===f.key))||void 0===r?void 0:r.control,D=null===(d=null==v?void 0:v.find(f=>"nam-dao"===f.key))||void 0===d?void 0:d.value,h=null===(l=null==v?void 0:v.find(f=>"nam-am-lich"===f.key))||void 0===l?void 0:l.value,J=null===(u=null==v?void 0:v.find(f=>"thang-am-lich"===f.key))||void 0===u?void 0:u.value,A=null===(a=null==v?void 0:v.find(f=>"ngay-am-lich"===f.key))||void 0===a?void 0:a.value;_.key=this.editorService.generatedSlug(`csvv ${D} ${h} ${J} ${A}`);let m,N,le=localStorage.getItem("csvv");le&&(m=JSON.parse(le)),N=m,(null==m?void 0:m.data)&&m.data.length>0?(null===(g=null==m?void 0:m.data)||void 0===g?void 0:g.find(f=>(null==f?void 0:f.key)===this._id))?(null===(p=null==m?void 0:m.data)||void 0===p||p.findIndex(f=>f.key===this._id),N.data[null===(y=null==m?void 0:m.data)||void 0===y?void 0:y.findIndex(f=>f.key===this._id)]=_):null==N||N.data.push(_):N={data:[_]},this._id?this.cauSieuVoViService.updateCauSieuVoVi(N,null==_?void 0:_.key).subscribe(f=>{var M;f?(this.isLoading=!1,this.cauSieuVoVi=f.data,this.editorService.getJSON(null===(M=this.cauSieuVoVi)||void 0===M?void 0:M.documentKey).subscribe(K=>{var V,b,x;this.so=K.data,this.so.formGroup=null===(V=this.cauSieuVoVi)||void 0===V?void 0:V.formGroup,this.so.key=null===(b=this.cauSieuVoVi)||void 0===b?void 0:b.key,this.so._id=null===(x=this.cauSieuVoVi)||void 0===x?void 0:x._id,this._id=this.so._id,this._snackBar.open("L\u01b0u th\xe0nh c\xf4ng","T\u1eaft",{duration:5,horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition})})):this.isLoading=!1}):this.cauSieuVoViService.addCauSieuVoVi(N,null==_?void 0:_.key).subscribe(f=>{var M;f?(this.isLoading=!1,this.cauSieuVoVi=f.data,this.editorService.getJSON(null===(M=this.cauSieuVoVi)||void 0===M?void 0:M.documentKey).subscribe(K=>{var V,b,x;this.so=K.data,this.so.formGroup=null===(V=this.cauSieuVoVi)||void 0===V?void 0:V.formGroup,this.so.key=null===(b=this.cauSieuVoVi)||void 0===b?void 0:b.key,this.so._id=null===(x=this.cauSieuVoVi)||void 0===x?void 0:x._id,this._id=this.so._id,this._snackBar.open("L\u01b0u th\xe0nh c\xf4ng","T\u1eaft",{duration:5,horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition})})):this.isLoading=!1})}}onChangeTrigerFormArray(e){var n;if(e.value){let s=null===(n=e.value)||void 0===n?void 0:n.trim().replace(new RegExp("[,;.\n]","g"),""),r=s.split(new RegExp("[0-9]","g"));r=r.filter(a=>!!a&&"t"!==a);let d=[],u=this.so.formGroup.find(a=>a.key===e.targetFormGroupKey).control.find(a=>a.key===e.targetFormControlKey);r.forEach((a,g)=>{var p;(a=a.trim()).slice(0,1)===a.slice(0,1).toLowerCase()&&"t"===a.slice(0,1)&&(a=(a=a.slice(1)).trim()),d.push({name:a,age:parseInt(null===(p=s.slice(s.indexOf(a)+a.length+1,s.indexOf(r[g+1])))||void 0===p?void 0:p.replace("t",""))})}),d.forEach(a=>{if((null==a?void 0:a.name)&&(null==a?void 0:a.age)){let g=new te.x,p=new te.x;g.autocomplete=u.addTemplate[0].autocomplete,g.label=u.addTemplate[0].label,g.placeholder=u.addTemplate[0].placeholder,g.required=u.addTemplate[0].required,g.suffix=u.addTemplate[0].suffix,g.type=u.addTemplate[0].type,g.value=null==a?void 0:a.name,p.autocomplete=u.addTemplate[1].autocomplete,p.label=u.addTemplate[1].label,p.placeholder=u.addTemplate[1].placeholder,p.required=u.addTemplate[1].required,p.suffix=u.addTemplate[1].suffix,p.type=u.addTemplate[1].type,p.value=null==a?void 0:a.age,u.value.push({control:[g,p]})}}),e.value=""}}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(ie.TB),i.Y36(W),i.Y36(ee.e),i.Y36(k.gz),i.Y36(q.Yg),i.Y36(k.F0),i.Y36(ne.ux),i.Y36(oe.uw))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-content"]],decls:5,vars:4,consts:[["mode","indeterminate",4,"ngIf"],[3,"formControlLabel","renderDocument","contentEditable","onSaveContent","changeTrigerFormArray"],["errorMessageDialog",""],["mode","indeterminate"],[1,"error-message-dialog"],["color","warn"]],template:function(e,n){if(1&e){const s=i.EpF();i.YNc(0,ge,1,0,"mat-progress-bar",0),i.TgZ(1,"caodaion-editor",1),i.NdJ("onSaveContent",function(d){i.CHM(s);const l=i.MAs(4);return n.onSaveCauSieuVoVi(d,l)})("changeTrigerFormArray",function(d){return n.onChangeTrigerFormArray(d)}),i._UZ(2,"caodaion-editor"),i.qZA(),i.YNc(3,pe,5,0,"ng-template",null,2,i.W1O)}2&e&&(i.Q6J("ngIf",n.isLoading),i.xp6(1),i.Q6J("formControlLabel","S\u1eda")("renderDocument",n.so)("contentEditable",n.contentEditable))},directives:[w.O5,$.pW,fe.p,se.Hw],styles:[""]}),t})();const _e=[{path:"",component:ve},{path:"them-moi",component:re},{path:":_id",component:re}];let me=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[k.Bz.forChild(_e)],k.Bz]}),t})();var ye=c(9777);c(449),c(7579),c(1135),c(576),c(9646),c(2722),c(3191),c(226);let xe=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({}),t})(),Ie=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[xe,E.BQ],E.BQ]}),t})(),Fe=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[w.ez,ye.l,me,U.N6,F.QW,se.Ps,oe.Is,Ie,ne.ZX,$.Cv,E.si]]}),t})()}}]);